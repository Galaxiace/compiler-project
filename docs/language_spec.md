# Спецификация языка MiniCompiler

## 1. Общая информация

Язык MiniCompiler — это упрощенный C-подобный язык, разработанный для учебного проекта компилятора. Поддерживает базовые типы данных, управляющие конструкции и функции.

- **Кодировка:** UTF-8
- **Регистрозависимость:** Да (идентификаторы `counter` и `Counter` — разные)
- **Максимальная длина идентификатора:** 255 символов

---

## 2. Лексическая грамматика (EBNF)

### Основные элементы

* letter = "a" | "b" | ... | "z" | "A" | "B" | ... | "Z" ;

* digit = "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" | "8" | "9" ;

* underscore = "_" ;

### Идентификаторы
* identifier = (letter | underscore), { letter | digit | underscore } ;

### Числовые литералы
* integer = digit, { digit } ;

* float = digit, { digit }, `"."`, digit, { digit } ;

### Строковые литералы
* string = '"', { character }, '"' ;

* character = ? любой символ UTF-8, кроме '"' и '\n' ? ;

### Булевы литералы
* boolean = `"true"` | `"false"` ;

### Ключевые слова
* keyword = `"if"` | `"else"` | `"while"` | `"for"` | `"int" `| `"float"` | `"bool"`
| `"return"` | `"true"` | `"false"` | `"void"` | `"struct"` | `"fn"` ;

### Операторы
* operator = `"+"` | `"-"` | `"*"` | `"/"` | `"%"` | `"="` | `"=="` | `"!="` | `"<"`
| `">"` | `"<="` | `">="` | `"&"` | `"&&"` | `"|"` | `"||"` ;

### Разделители
* delimiter = `"("` | `")"` | `"{"` | `"}"` | `";"` | `","` ;

### Пробельные символы
* whitespace = `" "` | `"\t"` | `"\n"` | `"\r"` ;

### Комментарии
* single_line_comment = `"//"`, { character }, (`"\n"` | EOF) ;

* multi_line_comment = `"/"`, { character }, `"*/"` ;

---

## 3. Категории токенов

### 3.1 Ключевые слова (Keywords)

| Токен | Описание | Пример |
|-------|----------|--------|
| `if` | Условный оператор | `if (x > 0) { ... }` |
| `else` | Альтернативная ветка | `if (x) { ... } else { ... }` |
| `while` | Цикл с предусловием | `while (i < 10) { i = i + 1; }` |
| `for` | Цикл со счетчиком | `for (i = 0; i < 10; i = i + 1) { ... }` |
| `int` | Целочисленный тип | `int counter = 42;` |
| `float` | Тип с плавающей точкой | `float pi = 3.14159;` |
| `bool` | Булев тип | `bool flag = true;` |
| `return` | Возврат из функции | `return 0;` |
| `true` | Истина | `bool flag = true;` |
| `false` | Ложь | `bool flag = false;` |
| `void` | Пустой тип | `void print() { ... }` |
| `struct` | Структура | `struct Point { int x; int y; }` |
| `fn` | Объявление функции | `fn main() { ... }` |

### 3.2 Идентификаторы (Identifiers)

Имена переменных, функций и структур.

**Правила:**
- Начинаются с буквы (a-z, A-Z) или подчеркивания (_)
- Могут содержать буквы, цифры и подчеркивания
- Максимальная длина: 255 символов
- Чувствительны к регистру

**Примеры:**
```
x
counter
var123
_private
camelCase
snake_case
CONSTANT_VALUE
```

### 3.3 Литералы (Literals)

#### Целочисленные литералы (Integer)
- Только десятичные цифры (0-9)
- Диапазон: [-2³¹, 2³¹-1] (32-битное знаковое целое)
- Без ведущих нулей

**Примеры:**
```
0
42
-17
2147483647 # максимальное значение
-2147483648 # минимальное значение
```

#### Литералы с плавающей точкой (Float)
- Десятичные цифры с точкой-разделителем
- Должны содержать цифры до и после точки

**Примеры:**
```
3.14159
0.5
-10.75
```


#### Строковые литералы (String)
- Заключаются в двойные кавычки (")
- Не могут содержать неэкранированные кавычки внутри
- Поддержка экранирования не требуется в Sprint 1

**Примеры:**
```
"Hello, World!"
""
"text with spaces"
```

#### Булевы литералы (Boolean)
- `true` — истина
- `false` — ложь

### 3.4 Операторы (Operators)

| Категория | Операторы | Описание | Пример |
|-----------|-----------|----------|--------|
| **Арифметические** | `+` | Сложение | `a + b` |
| | `-` | Вычитание | `a - b` |
| | `*` | Умножение | `a * b` |
| | `/` | Деление | `a / b` |
| | `%` | Остаток от деления | `a % b` |
| **Сравнения** | `==` | Равно | `a == b` |
| | `!=` | Не равно | `a != b` |
| | `<` | Меньше | `a < b` |
| | `>` | Больше | `a > b` |
| | `<=` | Меньше или равно | `a <= b` |
| | `>=` | Больше или равно | `a >= b` |
| **Логические** | `&` | Побитовое И | `a & b` |
| | `&&` | Логическое И | `a && b` |
| | `\|` | Побитовое ИЛИ | `a \| b` |
| | `\|\|` | Логическое ИЛИ | `a \|\| b` |
| **Присваивание** | `=` | Присваивание | `a = b` |

### 3.5 Разделители (Delimiters)

| Символ | Название | Использование |
|--------|----------|---------------|
| `(` | Левая круглая скобка | Выражения, параметры функций |
| `)` | Правая круглая скобка | Выражения, параметры функций |
| `{` | Левая фигурная скобка | Начало блока кода |
| `}` | Правая фигурная скобка | Конец блока кода |
| `;` | Точка с запятой | Завершение оператора |
| `,` | Запятая | Разделение параметров |

---

## 4. Пробелы и комментарии

### 4.1 Пробельные символы (Whitespace)
- Пробел (` `)
- Табуляция (`\t`)
- Перевод строки (`\n`) — Unix-style
- Возврат каретки (`\r`) — Windows-style (`\r\n` обрабатывается как один переход)

Пробельные символы игнорируются лексером (не создают токенов), но используются для отслеживания позиции.

### 4.2 Комментарии (Comments)

#### Однострочные комментарии
Начинаются с `//` и продолжаются до конца строки.

---

## 5. Обработка ошибок

Лексер должен обнаруживать следующие ошибки:

| Ошибка | Пример | Сообщение |
|--------|--------|-----------|
| Недопустимый символ | `@invalid` | `[1:1] Invalid character '@'` |
| Незакрытая строка | `"unterminated` | `[1:14] Unterminated string literal` |
| Незакрытый комментарий | `/* comment` | `[1:1] Unterminated multi-line comment` |
| Неправильное число | `123.` | `[1:1] Invalid number format: '123.'` |
| Слишком длинный идентификатор | (более 255 символов) | `[1:1] Identifier too long (300 > 255)` |
| Число вне диапазона | `3000000000` | `[1:1] Integer out of range (must be between -2^31 and 2^31-1): '3000000000'` |

---

## 6. Формат вывода токенов

Каждый токен выводится в формате:

`СТРОКА:КОЛОНКА ТИП_ТОКЕНА "ЛЕКСЕМА" [ЗНАЧЕНИЕ]`